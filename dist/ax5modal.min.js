!function(t,i){var e=ax5.util,a=function(){var t,a=this;this.main=function(){i&&i.call(this),this.config={clickEventName:"click",theme:"default",width:300,height:400,title:"",heading:{height:30},closeToEsc:!0}}.apply(this,arguments),this.activeModal=null,this.$={},t=this.config,t.id="ax5-modal-"+ax5.getGuid(),this.init=function(){},this.getContent=function(i,e){var a=[];if(a.push('<div id="'+i+'" data-modal-els="root" class="ax5-ui-modal '+e.theme+'">'),a.push('<div class="ax-modal-heading" data-modal-els="heading" style="height:'+t.heading.height+"px;line-height:"+t.heading.height+'px;">'),a.push(e.title||""),a.push("</div>"),a.push('<div class="ax-modal-body" data-modal-els="body">'),e.http){a.push('<iframe name="'+i+'-frame" src="" width="100%" height="100%" frameborder="0" data-modal-els="iframe"></iframe>'),a.push('<form name="'+i+'-form" data-modal-els="iframe-form">'),a.push('<input type="hidden" name="modalId" value="'+i+'" />');for(var o in e.http.param)a.push('<input type="hidden" name="'+o+'" value="'+e.http.param[o]+'" />');a.push("</form>")}return a.push("</div>"),a.push("</div>"),a.join("")},this.open=function(i,o){return e.isString(i)&&(i={title:t.title,msg:i}),this.activeModal?(console.log(ax5.info.getError("ax5modal","501","open")),this):(a.modalConfig={},jQuery.extend(!0,a.modalConfig,t),jQuery.extend(!0,a.modalConfig,i),i=a.modalConfig,this._open(i,o),this)},this._open=function(i,a){var o,d;if(o={width:i.width,height:i.height},jQuery(document.body).append(this.getContent(i.id,i)),this.activeModal=jQuery("#"+i.id),this.$={root:this.activeModal.find('[data-modal-els="root"]'),heading:this.activeModal.find('[data-modal-els="heading"]'),body:this.activeModal.find('[data-modal-els="body"]')},i.http&&(this.$.iframe=this.activeModal.find('[data-modal-els="iframe"]'),this.$["iframe-form"]=this.activeModal.find('[data-modal-els="iframe-form"]')),"undefined"==typeof i.position||"center"===i.position?(o.top=ax5.dom.height(document.body)/2-o.height/2,o.left=ax5.dom.width(document.body)/2-o.width/2):(o.left=i.position.left||0,o.top=i.position.top||0),this.activeModal.css(o),i.http)this.$.iframe.css({height:o.height-t.heading.height}),this.els["iframe-form"].attr({method:i.http.method}),this.els["iframe-form"].attr({target:i.id+"-frame"}),this.els["iframe-form"].attr({action:i.http.url}),this.els.iframe.on("load",function(){i.onload?i.onload.call(i):t.onload&&t.onload.call(i)}.bind(this)),this.els["iframe-form"].elements[0].submit();else{var d={id:i.id,theme:i.theme,width:i.width,height:i.height};e.extend(d,this.els),i.onload?i.onload.call(d):t.onload&&t.onload.call(d)}t.closeToEsc&&jQuery(window).on("keydown.ax-modal",function(t){this.onkeyup(t||window.event,i)}.bind(this))},this.onkeyup=function(t,i,e,a){t.keyCode==ax5.info.eventKeys.ESC&&this.close()},this.close=function(){return this.activeModal&&(this.activeModal.remove(),this.activeModal=null,jQuery(window).off("keydown.ax-modal"),opts&&opts.onStateChanged&&(that={state:"close"},opts.onStateChanged.call(that,that))),this}};e.is_function(i)&&(a.prototype=new i),t.modal=a}(ax5.ui,ax5.ui.root);